# 44. テキストデータの分割・整形（「姓 名」の分割など）

## 1. はじめに
「山田 太郎」というデータを「山田」と「太郎」の2列に分けたい。
「住所データから『都道府県』だけ抜き出したい」
こうした整形作業は、`SPLIT`関数や`LEFT`、`MID`関数を使いますが、位置指定が面倒です。

![テキストデータの分割](./../attachments/03_44_text_split_1769361313248.png)

## 2. スマートな分割指示
Geminiには、具体的なデータ例を見せるのが一番です。

> **プロンプト例**:
> 「A列に以下のような住所が入っています。
> 『東京都新宿区西新宿1-1-1』
> 『神奈川県横浜市西区...』
>
> ここから『都道府県』だけを抜き出してB列に表示する関数を作って。
> ただし、神奈川県や和歌山県のように3文字と4文字の場合があります」

Geminiは、「県」という文字を探すのか、あるいは都道府県リストと照合するのか、適切なロジック（例えば`LEFT`関数や正規表現）を提案してくれます。

## 3. フラッシュフィル的な活用
関数を使わずとも、Gemini上でデータを加工してしまう手もあります。
データをそのまま貼り付けて、「これをCSV形式で、姓と名に分けて出力して」と頼めば、整形済みのテキストを返してくれます。

---

## 4. まとめ
データの形が整っていないと、分析も活用もできません。
整形のロジックはAIに考えさせ、きれいなデータを短時間で手に入れましょう。